const prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,loaderEl=document.getElementById("loader"),countEl=document.getElementById("loaderCount");let count=0;if(prefersReducedMotion)loaderEl.style.display="none";else{const e=setInterval((()=>{count+=Math.floor(8*Math.random())+2,count>=100&&(count=100,clearInterval(e)),countEl.textContent=count,100===count&&(setTimeout((()=>loaderEl.classList.add("done")),400),setTimeout((()=>{loaderEl.style.display="none"}),1600))}),50)}const cursor=document.getElementById("cursor"),isTouchDevice="ontouchstart"in window||navigator.maxTouchPoints>0;if(!isTouchDevice&&window.innerWidth>768){let e=0,t=0,n=0,o=0,r=!1;document.addEventListener("mousemove",(e=>{n=e.clientX,o=e.clientY})),function a(){r?(e=n,t=o):(e+=.12*(n-e),t+=.12*(o-t)),cursor.style.left=e+"px",cursor.style.top=t+"px",requestAnimationFrame(a)}(),document.querySelectorAll("a, button, .service-row, .work-card, .test-card, input, textarea").forEach((e=>{e.addEventListener("mouseenter",(()=>cursor.classList.add("expand"))),e.addEventListener("mouseleave",(()=>cursor.classList.remove("expand")))}));const a=document.querySelector(".about-visual-wrap");a&&(a.addEventListener("mouseenter",(()=>{r=!0,cursor.classList.remove("expand"),cursor.classList.add("on-grid")})),a.addEventListener("mouseleave",(()=>{r=!1,cursor.classList.remove("on-grid")})))}else cursor.style.display="none",document.body.style.cursor="auto";const themeToggles=[document.getElementById("themeToggle"),document.getElementById("themeToggleMobile")].filter(Boolean),htmlEl=document.documentElement;function updateThemeUI(e){const t="dark"===e?"&#9681;":"&#9680;",n="dark"===e?"Switch to light theme":"Switch to dark theme";themeToggles.forEach((e=>{e.innerHTML=t,e.setAttribute("aria-label",n)}))}const savedTheme=localStorage.getItem("riventure-theme");savedTheme&&(htmlEl.setAttribute("data-theme",savedTheme),updateThemeUI(savedTheme)),themeToggles.forEach((e=>{e.addEventListener("click",(()=>{const e="light"===htmlEl.getAttribute("data-theme")?"dark":"light";htmlEl.setAttribute("data-theme",e),updateThemeUI(e),localStorage.setItem("riventure-theme",e)}))}));const navToggle=document.getElementById("navToggle"),mobileMenu=document.getElementById("mobileMenu");let menuOpen=!1;if(navToggle.addEventListener("click",(()=>{menuOpen=!menuOpen,navToggle.classList.toggle("active",menuOpen),navToggle.setAttribute("aria-expanded",String(menuOpen)),navToggle.setAttribute("aria-label",menuOpen?"Close navigation menu":"Open navigation menu"),mobileMenu.classList.toggle("open",menuOpen),document.body.style.overflow=menuOpen?"hidden":""})),mobileMenu.querySelectorAll("a").forEach((e=>{e.addEventListener("click",(()=>{menuOpen=!1,navToggle.classList.remove("active"),navToggle.setAttribute("aria-expanded","false"),mobileMenu.classList.remove("open"),document.body.style.overflow=""}))})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&menuOpen&&(menuOpen=!1,navToggle.classList.remove("active"),navToggle.setAttribute("aria-expanded","false"),mobileMenu.classList.remove("open"),document.body.style.overflow="",navToggle.focus())})),document.querySelectorAll('a[href^="#"]').forEach((e=>{e.addEventListener("click",(t=>{const n=e.getAttribute("href");if("#"===n)return;t.preventDefault();const o=document.querySelector(n);o&&(o.scrollIntoView({behavior:prefersReducedMotion?"auto":"smooth"}),o.setAttribute("tabindex","-1"),o.focus({preventScroll:!0}))}))})),prefersReducedMotion)document.querySelectorAll(".reveal-text, .fade-up").forEach((e=>e.classList.add("visible")));else{const e=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&e.target.classList.add("visible")}))}),{threshold:.15,rootMargin:"0px 0px -60px 0px"});document.querySelectorAll(".reveal-text, .fade-up").forEach((t=>e.observe(t)))}const logosStrip=document.querySelector(".logos-strip");if(logosStrip){const e=new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting&&(t.target.classList.add("in-view"),e.unobserve(t.target))}))}),{threshold:.2});e.observe(logosStrip)}const sp=document.querySelector(".hero-sphere");if(sp&&!prefersReducedMotion){let e=!1;window.addEventListener("scroll",(()=>{e||(requestAnimationFrame((()=>{sp.style.transform="translateY(calc(-50% + "+.15*window.scrollY+"px))",e=!1})),e=!0)}),{passive:!0})}isTouchDevice||prefersReducedMotion||document.querySelectorAll(".mag-btn").forEach((e=>{e.addEventListener("mousemove",(t=>{const n=e.getBoundingClientRect();e.style.transform="translate("+.2*(t.clientX-n.left-n.width/2)+"px, "+.2*(t.clientY-n.top-n.height/2)+"px)"})),e.addEventListener("mouseleave",(()=>{e.style.transform=""}))})),isTouchDevice||prefersReducedMotion||document.querySelectorAll(".work-card").forEach((e=>{e.addEventListener("mousemove",(t=>{const n=e.getBoundingClientRect(),o=(t.clientX-n.left)/n.width-.5,r=(t.clientY-n.top)/n.height-.5;e.style.transform="perspective(800px) rotateY("+6*o+"deg) rotateX("+6*-r+"deg)"})),e.addEventListener("mouseleave",(()=>{e.style.transform="",e.style.transition="transform 0.5s ease"})),e.addEventListener("mouseenter",(()=>{e.style.transition="none"}))}));const contactForm=document.getElementById("contactForm"),submitBtn=document.getElementById("submitBtn"),formStatus=document.getElementById("formStatus");contactForm.addEventListener("submit",(e=>{e.preventDefault();const t=document.getElementById("contact-name"),n=document.getElementById("contact-email");t.value.trim()?n.value.trim()&&n.validity.valid?(submitBtn.disabled=!0,submitBtn.textContent="Sending...",setTimeout((()=>{submitBtn.textContent="Sent âœ“",formStatus.textContent="Thank you! We'll be in touch within 24 hours.",setTimeout((()=>{contactForm.reset(),submitBtn.disabled=!1,submitBtn.innerHTML="Send Message &#8594;",formStatus.textContent=""}),3e3)}),1e3)):n.focus():t.focus()})),function(){const e=document.getElementById("aboutVisual"),t=e&&e.closest(".about-visual-wrap");if(!e||!t)return;let n=0,o=0,r=null;const a=50;let l=-9999,s=-9999,i=!1,c=null;const d=15,u=2800;let m=[];function h(){const a=t.getBoundingClientRect(),l=Math.min(window.devicePixelRatio||1,2);var s;n=a.width,o=a.height,e.width=n*l,e.height=o*l,e.style.width=n+"px",e.style.height=o+"px",r=e.getContext("2d"),r.scale(l,l),s=performance.now(),m=Array.from({length:d},((e,t)=>{const[n,o]=f();return{id:t,col:n,row:o,startTime:s+Math.random()*u}}))}function f(){const e=Math.max(1,Math.floor(n/a)),t=Math.max(1,Math.floor(o/a));return[Math.floor(Math.random()*e),Math.floor(Math.random()*t)]}function v(e){if(!r)return void(c=requestAnimationFrame(v));r.clearRect(0,0,n,o);const[t,d,h]="dark"===document.documentElement.getAttribute("data-theme")?[241,241,241]:[22,22,22],g=`${t},${d},${h}`,p=Math.floor(n/a),y=Math.floor(o/a),b=Math.floor(l/a),E=Math.floor(s/a);for(const t of m){const n=e-t.startTime,o=u/2;let l=0;if(n>=0&&n<o)l=n/o*.13;else if(n>=o&&n<u)l=(u-n)/o*.13;else if(n>=u){const[n,o]=f();t.col=n,t.row=o,t.startTime=e+400*Math.random(),l=0}l>.004&&(r.fillStyle=`rgba(${g},${l})`,r.fillRect(t.col*a+1,t.row*a+1,a-1,a-1))}if(i)for(let e=-2;e<=2;e++)for(let t=-2;t<=2;t++){const n=b+e,o=E+t;if(n<0||o<0||n>=p||o>=y)continue;const i=n*a+a/2,c=o*a+a/2,d=Math.sqrt((i-l)**2+(c-s)**2),u=Math.max(0,1-d/(2.2*a));u>.01&&(r.fillStyle=`rgba(${g},${.22*u})`,r.fillRect(n*a+1,o*a+1,a-1,a-1))}r.lineWidth=1;for(let e=0;e<=p;e++){const t=e*a;let n=0;if(i){const e=Math.max(0,1-Math.abs(t-l)/(2*a));n=e*e*.45}r.strokeStyle=`rgba(${g},${.09+n})`,r.beginPath(),r.moveTo(t,0),r.lineTo(t,o),r.stroke()}for(let e=0;e<=y;e++){const t=e*a;let o=0;if(i){const e=Math.max(0,1-Math.abs(t-s)/(2*a));o=e*e*.45}r.strokeStyle=`rgba(${g},${.09+o})`,r.beginPath(),r.moveTo(0,t),r.lineTo(n,t),r.stroke()}if(i)for(let e=-2;e<=3;e++)for(let t=-2;t<=3;t++){const n=(b+e)*a,o=(E+t)*a,i=Math.sqrt((n-l)**2+(o-s)**2),c=Math.max(0,1-i/(2*a));c>.01&&(r.beginPath(),r.arc(n,o,2.5*c,0,2*Math.PI),r.fillStyle=`rgba(${g},${.9*c})`,r.fill())}c=requestAnimationFrame(v)}if(t.addEventListener("mousemove",(t=>{const n=e.getBoundingClientRect();l=t.clientX-n.left,s=t.clientY-n.top,i=!0})),t.addEventListener("mouseleave",(()=>{i=!1,l=-9999,s=-9999})),"undefined"!=typeof ResizeObserver){new ResizeObserver(h).observe(t)}if(h(),!prefersReducedMotion){new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting?c||(c=requestAnimationFrame(v)):(cancelAnimationFrame(c),c=null)}))}),{threshold:.05}).observe(t)}}(),function(){const e=document.getElementById("ctaGlobe");if(!e)return;const t=Math.min(window.devicePixelRatio||1,2),n=520;e.width=n*t,e.height=n*t;const o=e.getContext("2d");o.scale(t,t);const r=260,a=260,l=218.4;let s,i=0,c=0,d=0,u=0,m=!1;var h=document.querySelector(".cta");h&&(h.addEventListener("mousemove",(function(t){var n=e.getBoundingClientRect(),o=(t.clientX-n.left)/n.width,r=(t.clientY-n.top)/n.height;u=1.6*(o-.5),d=-25*(r-.5),m=!0})),h.addEventListener("mouseleave",(function(){m=!1,u=0,d=0})));const f=[{lat:40.7,lon:-74},{lat:51.5,lon:-.1},{lat:35.7,lon:139.7},{lat:-33.9,lon:151.2},{lat:1.3,lon:103.8},{lat:48.9,lon:2.35},{lat:37.6,lon:-122.4},{lat:25.2,lon:55.3},{lat:-23.5,lon:-46.6},{lat:55.75,lon:37.6}];function v(e,t){var n=e*Math.PI/180,o=(t+i)*Math.PI/180,s=l*Math.cos(n)*Math.sin(o),d=-l*Math.sin(n),u=l*Math.cos(n)*Math.cos(o),m=c*Math.PI/180,h=Math.cos(m),f=Math.sin(m),v=d*f+u*h;return{x:r+s,y:a+(d*h-u*f),z:v,depth:v/l}}function g(e,t,n,r){if(!(e.length<2)){o.beginPath(),o.moveTo(e[0].x,e[0].y);for(var a=1;a<e.length;a++)o.lineTo(e[a].x,e[a].y);o.strokeStyle="rgba("+t+", "+n+")",o.lineWidth=r,o.stroke()}}function p(){o.clearRect(0,0,n,n);var e="dark"===document.documentElement.getAttribute("data-theme")?"241,241,241":"22,22,22";c+=.07*(d-c),o.beginPath(),o.arc(r,a,l,0,2*Math.PI),o.strokeStyle="rgba("+e+", 0.07)",o.lineWidth=1,o.stroke(),function(e,t,n){t.forEach((function(t){for(var n=[],o=-180;o<=180;o+=3){var r=v(t,o);r.z>0?n.push(r):(g(n,e,.05,.6),n=[])}g(n,e,.05,.6)})),n.forEach((function(t){for(var n=[],o=-90;o<=90;o+=3){var r=v(o,t);r.z>0?n.push(r):(g(n,e,.05,.6),n=[])}g(n,e,.05,.6)}))}(e,[-40,0,40],[-60,0,60]);for(var t=-80;t<=80;t+=14)for(var h=-180;h<=180;h+=14){var y=v(t,h);if(y.z>0){var b=.2*y.depth,E=1+1.2*y.depth;o.beginPath(),o.arc(y.x,y.y,E,0,2*Math.PI),o.fillStyle="rgba("+e+", "+b+")",o.fill()}}var M=[];f.forEach((function(t){var n=v(t.lat,t.lon);n.z>0&&(M.push(n),o.beginPath(),o.arc(n.x,n.y,5+4*n.depth,0,2*Math.PI),o.strokeStyle="rgba("+e+", "+.15*n.depth+")",o.lineWidth=.8,o.stroke(),o.beginPath(),o.arc(n.x,n.y,2+2*n.depth,0,2*Math.PI),o.fillStyle="rgba("+e+", "+.55*n.depth+")",o.fill())}));for(var x=0;x<M.length;x++)for(var w=x+1;w<M.length;w++){var T=M[x],S=M[w],L=Math.sqrt(Math.pow(T.x-S.x,2)+Math.pow(T.y-S.y,2));if(L<1.3*l&&L>.25*l){var I=(T.x+S.x)/2,k=(T.y+S.y)/2-.18*L,A=(T.depth+S.depth)/2;o.beginPath(),o.moveTo(T.x,T.y),o.quadraticCurveTo(I,k,S.x,S.y),o.strokeStyle="rgba("+e+", "+.08*A+")",o.lineWidth=.7,o.stroke()}}i+=m?.12+u:.12,s=requestAnimationFrame(p)}var y=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting?p():cancelAnimationFrame(s)}))}),{threshold:.05});prefersReducedMotion?(p(),cancelAnimationFrame(s)):y.observe(e)}(),document.querySelectorAll('.service-row[tabindex="0"]').forEach((e=>{e.addEventListener("keydown",(t=>{"Enter"!==t.key&&" "!==t.key||(t.preventDefault(),e.click())}))}));